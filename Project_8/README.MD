# üöó Segmentation Multi-Classes pour V√©hicules Autonomes

## üìã Description du Projet

Ce projet d√©veloppe un syst√®me de segmentation s√©mantique d'images de rue destin√© aux v√©hicules autonomes. Il permet l'identification et la segmentation automatique de diff√©rents √©l√©ments urbains : v√©hicules, pi√©tons, mobilier urbain, infrastructure routi√®re, etc.

Le syst√®me s'inscrit dans une cha√Æne compl√®te de vision par ordinateur embarqu√©e pour l'automobile autonome, traitant les images en temps r√©el pour alimenter les syst√®mes de d√©cision.

## üóÇÔ∏è Structure du Projet

```
‚îú‚îÄ‚îÄ notebooks/
‚îÇ   ‚îú‚îÄ‚îÄ p8_notebook.py          # Notebook principal d'entra√Ænement des mod√®les
‚îÇ   ‚îú‚îÄ‚îÄ requirements.txt        # D√©pendances pour l'entra√Ænement et exp√©rimentation
‚îÇ   ‚îî‚îÄ‚îÄ content/
‚îÇ       ‚îî‚îÄ‚îÄ data/
‚îÇ           ‚îú‚îÄ‚îÄ new_images_to_predict/     # Images diverses pour tests d'inf√©rence
‚îÇ           ‚îî‚îÄ‚îÄ test_images_sample/        # √âchantillon Cityscapes avec masques
‚îú‚îÄ‚îÄ utils/
‚îÇ   ‚îî‚îÄ‚îÄ utils.py                # Fonctions communes (pr√©traitement, chargement, inf√©rence)
‚îú‚îÄ‚îÄ api/                        # [En d√©veloppement] API FastAPI
‚îÇ   ‚îî‚îÄ‚îÄ requirements.txt        # D√©pendances l√©g√®res pour l'API uniquement
‚îú‚îÄ‚îÄ .env                        # Variables d'environnement (MLFlow, MinIO)
‚îî‚îÄ‚îÄ README.md
```

> **Note** : Les mod√®les entra√Æn√©s sont stock√©s et versionn√©s via **MLFlow** avec artefacts sur **MinIO**, pas en local.

**√âtat actuel du d√©veloppement :**
- ‚úÖ **Entra√Ænement des mod√®les** : Complet (notebook + MLFlow + MinIO)
- ‚úÖ **Fonctions d'inf√©rence** : D√©velopp√©es et pr√™tes
- üîÑ **API FastAPI** : En cours de d√©veloppement
- üîÑ **D√©ploiement** : Conteneurisation Docker + NAS personnel

## üè∑Ô∏è Classes de Segmentation

Le mod√®le identifie **8 cat√©gories principales** :

1. **Route** - Chauss√©e et surfaces roulantes
2. **Trottoir** - Zones pi√©tonnes
3. **B√¢timents** - Structures architecturales
4. **V√©g√©tation** - Arbres, buissons, espaces verts
5. **V√©hicules** - Voitures, camions, bus
6. **Personnes** - Pi√©tons, cyclistes
7. **Signalisation** - Panneaux, feux de circulation
8. **Mobilier urbain** - Poteaux, barri√®res, abribus

## üß† Architecture Technique

### Mod√®les Impl√©ment√©s
Utilisation de la biblioth√®que **[segmentation_models](https://github.com/qubvel/segmentation_models)** de qubvel pour l'impl√©mentation des architectures.

**Architectures principales :**
- **U-Net** : Architecture encoder-decoder classique
- **FPN** (Feature Pyramid Network) : R√©seau √† pyramide de caract√©ristiques

**Backbones test√©s :**
```python
# Mod√®les avec backbones par d√©faut
('U-Net', None)     # Backbone U-Net int√©gr√©
('FPN', None)       # Backbone VGG16 par d√©faut

# Mod√®les avec backbones pr√©-entra√Æn√©s (encodeurs gel√©s)
('U-Net', 'mobilenetv2')
('U-Net', 'efficientnetb0') 
('FPN', 'mobilenetv2')
('FPN', 'efficientnetb0')
('FPN', 'resnet34')

# Fine-tuning s√©lectif (encodeurs entra√Ænables)
('U-Net', 'mobilenetv2')
('FPN', 'efficientnetb0') 
('FPN', 'resnet34')
```

**Strat√©gies d'entra√Ænement :**
- **Encodeurs gel√©s** : Transfer learning avec features pr√©-entra√Æn√©es fig√©es
- **Fine-tuning** : Ajustement fin des encodeurs pr√©-entra√Æn√©s
- **Entra√Ænement from scratch** : Sans pr√©-entra√Ænement (backbones par d√©faut)

### Stack Technologique
- **Framework** : Keras/TensorFlow
- **Architectures** : [segmentation_models](https://github.com/qubvel/segmentation_models) (qubvel)
- **Gestion des exp√©riences** : MLFlow
- **Stockage des artefacts** : MinIO (S3-compatible)
- **API** : FastAPI *(en d√©veloppement)*
- **D√©ploiement** : Docker + NAS personnel *(solutions souveraines)*

## üìä Dataset

- **Source** : Cityscapes Dataset
- **Organisation locale** :
  - `notebooks/content/data/test_images_sample/` : √âchantillon avec masques de v√©rit√© pour tests d'inf√©rence
  - `notebooks/content/data/new_images_to_predict/` : Images de test diverses pour validation

## üöÄ Installation et Configuration

### Installation
```bash
git clone https://github.com/GrgMdmn/OpenClassrooms_AI_Projects.git
cd OpenClassrooms_AI_Projects/Project_8

# Pour l'exp√©rimentation et l'entra√Ænement
cd notebooks
pip install -r requirements.txt

# Pour l'API uniquement (plus l√©ger)
cd api  
pip install -r requirements.txt
```

### Configuration MLFlow et MinIO
Cr√©er un fichier `.env` √† la racine du projet :
```bash
MLFLOW_TRACKING_URI=http://localhost:5000 # mlflow url
MLFLOW_S3_ENDPOINT_URL=http://localhost:9000 # minio url
AWS_ACCESS_KEY_ID=your_access_key # minio login
AWS_SECRET_ACCESS_KEY=your_secret_key # minio password
```

Le chargement des variables se fait via `python-dotenv` dans le notebook et l'API.

## üåê API et D√©ploiement

### API FastAPI (En d√©veloppement)
L'API utilisera les fonctions de `utils.py` et sera d√©ploy√©e via Docker sur NAS personnel pour maintenir la souverainet√© des donn√©es.

## üîÆ Am√©liorations Futures

- **Pr√©traitement adaptatif** : Pr√©traitement sp√©cifique √† chaque backbone au lieu de la normalisation g√©n√©rique (division par 255)
- **G√©n√©ralisation des conditions** : Extension au-del√† des conditions urbaines de Cityscapes (m√©t√©o, environnements vari√©s)
- **Optimisation temps r√©el** : √âvaluation et am√©lioration des performances d'inf√©rence
- **R√©solution variable** : Support de tailles d'images variables au-del√† du format fixe 224x224
- **Transfer learning cibl√©** : Utilisation de backbones pr√©-entra√Æn√©s sur Mapillary Vistas plut√¥t qu'ImageNet pour un meilleur alignement domaine
- **Segmentation des personnes** : Am√©lioration de l'IoU sur les humains via data augmentation (IA g√©n√©rative)
- **Limitation du dataset** : Les performances similaires entre mod√®les sugg√®rent une limite li√©e √† la qualit√©/diversit√© des donn√©es d'entra√Ænement

---

*Projet d√©velopp√© dans une approche de souverainet√© technologique, privil√©giant les solutions open-source et l'h√©bergement sur infrastructure personnelle.*